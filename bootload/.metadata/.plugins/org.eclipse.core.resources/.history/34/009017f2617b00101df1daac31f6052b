/*
 * w25q64.c
 *
 *  Created on: Aug 17, 2025
 *      Author: Administrator
 */

#ifndef USER_W25Q64_C_
#define USER_W25Q64_C_

#include "w25q64.h"


/**
  * @brief SPI1 读一个字节
  * @param None
  * @retval None
  */
uint8_t flash_read_byte(void)
{
    uint8_t t_data, r_data;

    if(HAL_SPI_TransmitReceive(&hspi2, &t_data, &r_data, 1, 0xFFFFFF) != HAL_OK)
    {
        r_data = 0xff;
    }
    return r_data;
}

/**
  * @brief SPI1 写一个字节
  * @param byte 写入的字节
  * @retval 写状态 0成功 1失败
  */
static uint8_t spi1_flash_send_byte(uint8_t byte)
{
    uint8_t r_data;

    if(HAL_SPI_TransmitReceive(&hspi2, &byte, &r_data, 1, 0xFFFFFF) != HAL_OK)
    {
      return 1;
    }
    return 0;
}

/**
  * @brief FLASH 写使能
  * @param None
  * @retval None
  */
static void spi1_flash_write_enable(void)
{
    cs_low;
    spi1_flash_send_byte(0x06);
    cs_high;
}


#endif /* USER_W25Q64_C_ */
